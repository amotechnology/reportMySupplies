<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/start/jquery-ui.css" type="text/css"
        rel="Stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">



    <script>
        const locations = ['2100 (Cardiology)',
            '3500 (Observation)',
            '4400 (Surgical ICU Burn/Trauma)',
            '4900 (Oncology)',
            '4900 (Short Stay Surgery)',
            '5200 (General Medicine)',
            '5300',
            '5400',
            '5500',
            '5600 (Cardiothoracic ICU)',
            '58 APN',
            '58AP (Antepartum)',
            '58LD (Labor & Delivery)',
            '58LDN (Labor & Delivery)',
            '5900 (GYN Oncology)',
            '6200 (General Medicine)',
            '6200 (General Medicine)',
            '6200 (Surgery ENT/Plastics PCU)',
            '6300 Pulmonary PCU',
            '6300 AHF',
            '6400 General Surgery',
            '6500 General Surgery / Trauma',
            '6800 Mother & Baby Unit',
            '6800 N Nursery',
            '6900 Colorectal/Urology',
            '7200 Cardiac Surgery',
            '7300 Cardiothoracic',
            '7400 Thoracic Surgery',
            '7500 Cardiovascular',
            '7800 BMT ICU',
            '7800 SICU',
            '7900 79MED1',
            '7900 79MED2',
            '8100 Cardiology',
            '8200 Cardiac Critical Care ICU',
            '8300 CTICU',
            '8300 MICU',
            '8400 ICU',
            '8800 Bone Marrow Transplant',
            '8900 General Medicine/Pulmonary',
            '8900 PPCU',
            '9200 Cardiology',
            '9400 ICU',
            '9800 Bone Marrow Transplant',
            '10200 Cardiology',
            '10400 Neuro ICU',
            '10500 Neurosurgery',
            '10800 Bone Marrow Transplant',
            '11200 General Medicine/Pulmonary',
            '11300 Neurosurgery',
            '11400 Neuro Medicine',
            '11500 Neurosurgery',
            '11800 Medical Oncology',
            '12100 General Medicine',
            '12200 General Medicine',
            '12800 Medical Oncology',
            '14300 Schukar General Medicine',
            '14400 General Medicine',
            '14500 (General Medicine)',
            '15300 (Adult Psych)',
            '15400 (Gero Psych)',
            '15500 (Psych ICU)',
            '16300 (PCU)',
            '16300 (Surgical PCU)',
            '16400 (Surgical PCUX)',
            '17300 (ENT / Plastics)',
            '17400 (Ortho)',
            'CAM (Minor Procedure)',
            'Cancer Care Center',
            'Cardiac Cath Lab',
            'DDCC Endoscopy',
            'Emergency',
            'EP Lab',
            'INV CV Prep Rcvy',
            'NACC (Newborn Assessment Center)',
            'NDDC Endoscopy',
            'OC (Operating Room)',
            'OR Pod 1',
            'OR Pod 2',
            'OR Pod 3',
            'OR Pod 4',
            'OR Pod 5',
            'PSC 2 - Delmar location',
            'PSC 3 - Delmar location',
            'South County Endoscopy',
            'South County Operating Room',
            "WAC (Women's Assessment Center)"]

        function addLocOption(location) {
            $('#location').append(`<option value="${location}">${location}</option>`)
        }

        function generateLink(email, location) {
            return `https://www.reportmysupplies.app?email=${encodeURI(email)}&location=${encodeURI(location)}`;
        }

        function generateLinksHTML() {
            let html = `
        <div class="btn-toolbar btn-toolbar-lg text-center" role="toolbar" />
            <div class="btn-group btn-group-lg" role="group">
                <button class = "btn-light btn-lg" id="copy-button">Copy Link</button>
            </div>
            <div class="btn-group" role="group">
                <button class = "btn-light btn-lg" id="open-button">Open Link</button>
            </div>
        </div>
        `
            return html;
        }

        const copyToClipboard = (str) => {
            const el = document.createElement('textarea');
            el.value = str;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
        };

        function updateResponseArea() {
            let locVal = $('#location').children("option:selected").val();
            if (locVal == "[select a location]") {
                locVal = "";
            }
            let emailVal = $('#email').val();
            if (emailVal == "undefined") {
                emailVal = "";
            }
            let locEmpty = (locVal == "");
            let emailEmpty = (emailVal == "");
            let html = "";

            if (locEmpty && emailEmpty) {
                html = `<p><i>Please input your email address and/or location</i></p>`;
            } else {
                if (locEmpty) {
                    html = `<p>Here's your form link with pre-filled email address <strong>${emailVal}</strong>, but no pre-filled location:</p>`;
                } else if (emailEmpty) {
                    html = `<p>Here's your form link with pre-filled location <strong>${locVal}</strong>, but no pre-filled email address:</p>`;
                } else {
                    html = `<p>Here's your form link with pre-filled email address <strong>${emailVal}</strong> and pre-filled location <strong>${locVal}</strong>:</p>`;
                }
                html = html + generateLinksHTML();
            }
            $('#response-area').html(html);

            const prefilledLink = generateLink(emailVal, locVal);
            $('#copy-button').on('click', function () {
                copyToClipboard(prefilledLink);
                $('#copy-button').text("Link Copied");
            });
            $('#open-button').on('click', function () {
                window.open(prefilledLink, '_blank');
            });
        }

        $(document).ready(function () {
            locations.forEach(addLocOption);
            updateResponseArea()
            $('#location').on('change', function () {
                updateResponseArea()
            });
            $('#email').on('change', function () {
                updateResponseArea()
            });
        });
    </script>



    <title>BJC Personalized Supply-Chain Form Generator</title>
</head>

<body style="background-color: rgb(217, 239, 252);">
    <nav class = "navbar navbar-expand-lg navbar-light bg-light text-center"><h3>BJC Personalized Supply-Chain Form Generator</h3></nav>
    <div class="container" style="background-color: white;">
        <br>
        <p><strong>Info:</strong> This site will give you a link to the 'Supply Chain Tracking at BJC' form with your details already filled in.
            Just enter your employee email address and/or location, then save the generated link as a bookmark (or somewhere else
            you can access easily).</p>
        <div class='form-group'>
            <br>
            <label for="emailId">Employee email address to pre-fill</label>
            <input type="email" id="email" class="form-control" />
            <br>
            <label for="location">Location to pre-fill</label>
            <select id="location" name="location" class="form-control">
                <option value="[select a location]">[select a location]</option>
            </select>
        </div>
        <br>
        <div id="response-area" class = "text-center" style="background-color: lightgoldenrodyellow; padding: 10px;"></div>
        <br>
    </div>
</body>

</html>